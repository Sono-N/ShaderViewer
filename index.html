<!DOCTYPE html>
<html>
  <head>
    <title>WebGL</title>
    <script type="text/javascript" src="js/jquery-3.4.0.min.js"></script>    
    <script src="js/script.js" type="text/javascript"></script>
    <script src="js/myMatrix.js" type="text/javascript"></script>
    <script id="vshader" type="shader">
      attribute vec3 position;
      attribute vec3 normal;
      attribute vec4 color;

      uniform mat4 mvpMatrix;
      uniform mat4 invMatrix;
      uniform vec3 lightDirection;
      uniform vec3 eyeDirection;
      uniform vec4 ambientColor;

      varying   vec4 vColor;

      void main(void){
        vec3 invLight = normalize(invMatrix * vec4(lightDirection, 0.0)).xyz;
        vec3 invEye = normalize(invMatrix * vec4(eyeDirection, 0.0)).xyz;
        vec3 halfLE = normalize(invLight + invEye);
        float diffuse = clamp(dot(normal, invLight), 0.0, 1.0);
        float specular = pow(clamp(dot(normal, halfLE), 0.0, 1.0), 50.0);
        vColor = color * vec4(vec3(diffuse), 1.0) + vec4(vec3(specular), 1.0)+ ambientColor;
        gl_Position = mvpMatrix * vec4(position, 1.0);
      }
    </script>
    <script id="fshader" type="shader">
      precision mediump float;

      varying vec4 vColor;
      void main(void){
        gl_FragColor = vColor;
      }
    </script>
  </head>
  <body>
    <canvas id="canvas" width="500" height="250"></canvas>
    <div id = "ui">
    </div>

    <form >
      Light Direction
      <input type="text" id="light-direction-x" value=1>
      <input type="text" id="light-direction-y" value=1>
      <input type="text" id="light-direction-z" value=1>
    </form>
    <br/>
    <textarea name="vshader" cols="90" rows="20" id="vshader_input">
      /*Vertex*/
      attribute vec3 position;
      attribute vec3 normal;
      attribute vec4 color;

      uniform mat4 mvpMatrix;
      uniform mat4 invMatrix;
      uniform vec3 lightDirection;
      uniform vec3 eyeDirection;
      uniform vec4 ambientColor;

      varying   vec4 vColor;

      void main(void){
        vec3 invLight = normalize(invMatrix * vec4(lightDirection, 0.0)).xyz;
        vec3 invEye = normalize(invMatrix * vec4(eyeDirection, 0.0)).xyz;
        vec3 halfLE = normalize(invLight + invEye);
        float diffuse = clamp(dot(normal, invLight), 0.0, 1.0);
        float specular = pow(clamp(dot(normal, halfLE), 0.0, 1.0), 50.0);
        vColor = color * vec4(vec3(diffuse), 1.0) + vec4(vec3(specular), 1.0)+ ambientColor;
        gl_Position = mvpMatrix * vec4(position, 1.0);
      }
      </textarea>
      <textarea name="fshader" cols="90" rows="20" id="fshader_input">
      /*Fragment*/
      precision mediump float;
      varying vec4 vColor;
      void main(void){
        gl_FragColor = vColor;
      }
      </textarea>
      <br/>
      <input type="button" value="set" onClick="kakunin()">
    </form>
    <script>
      function kakunin(){
        ret = confirm("Yahoo!Japanへ飛びます。宜しいですか？");
        if (ret == true){
          location.href = "http://www.yahoo.co.jp/";
        }
      }
    </script>
  </body>
</html>